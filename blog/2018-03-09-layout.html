<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>教材 ppt のレイアウト半自動作成 - easy cure</title>
  <meta name="author" content="saito1369">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://saito1369.github.io/blog/2018-03-09-layout.html">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="easy cure" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://saito1369.github.io/blog/2018-03-09-layout.html">
  <meta property="og:title" content="教材 ppt のレイアウト半自動作成 - easy cure">
  

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  

</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">easy cure</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="saito1369.github.io">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="easy cure" />
    <meta itemprop="description" content="memo" />
    <meta itemprop="url" content="http://saito1369.github.io" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-03-09T00:00:00+09:00"  data-updated="true" itemprop="datePublished dateCreated">2018-03-09 (Fri)</time>
        
           | <a href="#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="http://saito1369.github.io">Comments</a>
        
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        教材 ppt のレイアウト半自動作成
        
    </h1>
    
    


  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. はじめに</a></li>
<li><a href="#sec-2">2. やりたいこと(目的)</a></li>
<li><a href="#sec-3">3. 調査</a></li>
<li><a href="#sec-4">4. やったこと</a></li>
<li><a href="#sec-5">5. 仕様とつかいかた</a>
<ul>
<li><a href="#sec-5-1">5.1. 一枚いちまいのスライドに, progress bar をつける</a></li>
<li><a href="#sec-5-2">5.2. 現在のページ数/全体のページ数  としてページ数を追加する</a></li>
<li><a href="#sec-5-3">5.3. gray out した目次を自動で作成して挿入する</a></li>
<li><a href="#sec-5-4">5.4. 階層の情報を各スライドに表示する</a></li>
<li><a href="#sec-5-5">5.5. 章ごとに分割して作成したスライドを統合する</a></li>
<li><a href="#sec-5-6">5.6. 学生用の資料を自動で作成する</a></li>
<li><a href="#sec-5-7">5.7. 教師用の資料を作成</a></li>
<li><a href="#sec-5-8">5.8. そのほか</a>
<ul>
<li><a href="#sec-5-8-1">5.8.1. 目次スライドを消去した新しいスライドを作成する</a></li>
<li><a href="#sec-5-8-2">5.8.2. 目次のフォント大きさを変更</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-6">6. 使用例</a></li>
<li><a href="#sec-7">7. そのほか注意事項</a></li>
<li><a href="#sec-8">8. 追記 <span class="timestamp-wrapper"><span class="timestamp">[2019-02-15 Fri]</span></span></a>
<ul>
<li><a href="#sec-8-1">8.1. hash へのアクセス(Scripting.Dictionary)</a></li>
<li><a href="#sec-8-2">8.2. Sgn(array)=0 の件</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
#+File Created: <span class="timestamp-wrapper"><span class="timestamp">&lt;2015-06-01 Mon 10:55&gt;</span></span><br  />
#+Last Updated: <span class="timestamp-wrapper"><span class="timestamp">&lt;2019-02-16 Sat 16:03&gt;</span></span><br  />
</p>
<p>
ここで紹介した機能をもつプログラムは以下に置かれている.<br  />
<a href="https://github.com/saito1369/work-lib-Basic">https://github.com/saito1369/work-lib-Basic</a><br  />
</p>

<p>
<!-- more --><br  />
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> はじめに</h2>
<div class="outline-text-2" id="text-1">
<p>
発表資料, 講義資料作成には PowerPoint を使っている.<br  />
PowerPoint によるプレゼン及び講義での利用については, 様々な考察がなされているようである(PowerPoint プレゼン とかで検索すれば山ほどでてくる).<br  />
</p>

<p>
そんな中, 自分が講義等で使ってみて感じた一番の感想は,<br  />
「今このページが全体の中でどこにいるのか, というのがこのままじゃイマイチわかりにくいんじゃないかなぁ」<br  />
ということである.<br  />
</p>

<p>
PowerPoint 的な資料(というか紙芝居的に, 一次元的に見せていく方法全般)では, 常にそれぞれのスライドしか見えてない状態なので, 今いる場所が全体の中のどのへんにいるのか見失いがちなのではないか？<br  />
全体というのは, 今回の講義の中で, どれくらい進んでるのかとか, あるいは15 回の講義全体の中でどれくらいの位置に今いるのか, この章の中でどこを今やってるのか(どの階層にいるのか)とか, そういったことである.<br  />
</p>

<p>
今どういう位置づけの場所をやってるのか, がわからなければ当然内容の理解も厳しくなるわけである.<br  />
普通は教科書の目次構造がこのガイドの役目を果たしてるのではと思われるのだが, 教科書がある科目ばかりではないのでどーしたもんかなと思っている.<br  />
自分自身でも正直わかりにくいことがあったので, 恐らく学生もそうなんじゃないかなぁ, と思ってとある学生に聞いてみた.<br  />
あとどれくらいで講義が終わるのか, 早くおわってさっさと帰れそうか, 遅れててギリまでかかりそうなのか, わかったら良いと思う, という答えが返ってきた.<br  />
うーん何か質問の趣旨とは違うような気もするけど, とりあえず学生も講義の中で今いる位置を把握したいんだろうと思うことにしよう.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> やりたいこと(目的)</h2>
<div class="outline-text-2" id="text-2">
<p>
ここで実現したいと思ってることは以下である.<br  />
「PowerPoint の資料一枚いちまいで, いろんな意味での全体における位置がぱっとわかるようにしたい.」<br  />
</p>

<p>
教科書はなくても, 一連の資料には教科書のような目次の階層的な構造があるはずである.<br  />
その構造と現在地が資料一枚いちまいに記されてて, 敷衍した状態での位置がわかるようになってる感じをイメージしている.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 調査</h2>
<div class="outline-text-2" id="text-3">
<p>
最初に見たのは以下の URL である.<br  />
<a href="http://oshiete.goo.ne.jp/qa/7109697.html">http://oshiete.goo.ne.jp/qa/7109697.html</a><br  />
ここで質問されてるのは, それぞれの slide に progress bar みたいなもんをつけたいがどーすればいいか, というものだ.<br  />
PowerPoint 資料を作成のちにマクロを動かして, 現在のページが全体のどの位置にあるかを表示する.<br  />
これを使うことで, 階層構造こそわからないものの, 1 回の講義及び発表の中で今どのへんにいるのかを視覚的にわかりやすく示せるのではないかと思う.<br  />
学生が言っていた, あとどれくらいで講義がおわるのか, ということについてはこれでばっちりわかるんでは？<br  />
</p>

<p>
次に参考になりそうなのが以下の URL にある slideshare である.<br  />
<a href="http://www.slideshare.net/hamadakoichi/tree-basedmodelsandrandomforests">http://www.slideshare.net/hamadakoichi/tree-basedmodelsandrandomforests</a><br  />
目次(の階層構造)を最初に見せて, 今やってるところ以外を gray out する.<br  />
この表示方法はとってもかんたんだし, 今自分がいるところが全体の中でどこなのか, とてもわかりやすいと思う.<br  />
この gray out 方式の目次を一般的にしてより便利に使えるようにしたい.<br  />
ただ, 一枚いちまいの slide に情報を載せてるわけではないというてんについては, もう少し考える必要があるかなと思った.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> やったこと</h2>
<div class="outline-text-2" id="text-4">
<p>
色々考えたり試行錯誤していくうちに, 目的を達成するために具体的にすべきことがいくつかでてきたのでここでまとめておく.<br  />
1 から 4 は今回のやりたいこと(目的)に直接関与していそうな事案.<br  />
5 以降は ppt の使い回しや利便性を考えて作成してみたものである.<br  />
</p>

<ol class="org-ol">
<li>一枚いちまいのスライドに, progress bar をつける.<br  />
スライドの左下に, 今どこまで進んでるかを示す bar を作成する.<br  />
</li>
<li>現在のページ数/全体のページ数  としてページ数を追加する.<br  />
全体のページ数 の情報がないとあとどれくらいあるのかがよくわからないので.<br  />
スライドに右下に置いておくことにする.<br  />
</li>
<li>gray out した目次を自動で作成して挿入する.<br  />
作成した slide に対して, 別のテキストファイルに目次を書いておくと gray out した目次を自動で挿入してくれる.<br  />
目次には階層構造があるのが普通なので, 階層構造もそれとわかるように表示する.<br  />
</li>
<li>階層の情報を各スライドに表示する.<br  />
資料の右上には, gray out した小さい目次(簡易版)を載せる<br  />
  (今見ているスライドとは関係ない場所を gray out することで自分がいる位置が明快になる).<br  />
資料の左上には, 今見ているスライドの階層的な目次を載せる<br  />
  (上の補足的な情報として).<br  />
</li>
<li>章ごとに分割して作成したスライドを統合する<br  />
あまりでかい ppt 資料を作るとフリーズしたりするので, 資料は予め章毎にまとまった(内容でまとまった)単位で作成しておく.<br  />
必要な部分だけ結合することで次の講義での資料をさくっと作成したい.<br  />
内容ごとのまとまりで資料を作ることで再利用がかんたんになるだろう.<br  />
</li>
<li>学生用の資料を自動で作成する<br  />
学生は講義を聞いてるだけだとほぼ確実に寝るわけである.<br  />
PowerPoint を使った講義では板書をすることがあまり無く, 学生がメモをとったりすることがないので尚更である.<br  />
そこで, 講義資料を紙で配って, 重要な部分を穴開きにしといて穴埋めさせたい,<br  />
手を動かせば寝る確率は減るだろう.<br  />
いちいち学生用の穴埋め資料を別に作るのは超めんどくさいので, 学生用の穴あき資料を自動で作成できるようにする.<br  />
学生には見せない slide (演習の答えなど)の削除などもここで行う.<br  />
</li>
<li>教師用の資料を作成<br  />
上記のような資料を作って講義をしていると, 穴埋めが色々ありすぎてどこが穴埋めになってるのか, よくわかんなくなってしまうことがある.<br  />
大写しになっている slide には穴埋めの情報が書いてないからである.<br  />
自分用に, 今回どこが穴埋めになっているのかを示した教師用の資料を自動で作成できるようにする.<br  />
これを印刷しておけばどこが穴埋めなのかがわかる.<br  />
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> 仕様とつかいかた</h2>
<div class="outline-text-2" id="text-5">
<p>
それぞれの仕事を行う VBA プログラムを作成した.<br  />
<a href="https://github.com/saito1369/work-lib-Basic/lecture/AutoPowerPointDecoration.bas">https://github.com/saito1369/work-lib-Basic/lecture/AutoPowerPointDecoration.bas</a><br  />
</p>

<p>
以下使い方などの説明である.<br  />
</p>
</div>
<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> 一枚いちまいのスライドに, progress bar をつける</h3>
<div class="outline-text-3" id="text-5-1">
<p>
関数名: p02_pageCountsBox<br  />
仕様:<br  />
今作業している ppt ファイルが hoge.ppt だとする.<br  />
default では, 挿入された gray out 目次ページ(後述. p01_grayTOC)以外のスライドの全てに progress bar をつける.<br  />
テキストファイル hoge.txt に以下のように書いておくと,<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::---::
5,10
</pre>
</div>
<p>
5 page 目と 10 page 目には progress bar をつけない.<br  />
テキストファイルの名前は default では ppt ファイルの名前と同じにする(hoge.ppt であれば hoge.txt. 違うファイル名も指定可能).<br  />
各々のスライドの左下に図形で作成された progress bar が追加される.<br  />
</p>

<p>
こんな感じである.<br  />
<img src="dat/img/layout-countbox.png" alt="layout-countbox.png" /><br  />
全体で 26 page あって, 今は 4 page 目である.<br  />
</p>

<p>
<img src="dat/img/layout-countbox2.png" alt="layout-countbox2.png" /><br  />
23 page 目. もうそろそろ終りそうだ!! ということがぱっとみてわかる.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> 現在のページ数/全体のページ数  としてページ数を追加する</h3>
<div class="outline-text-3" id="text-5-2">
<p>
関数名: p03_pageNum<br  />
仕様:<br  />
default では, 全体のページ数は挿入された gray out 目次ページ(後述. p01_grayTOC)を除く.<br  />
テキストファイルに以下のように書いておくと,<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::---::
5,10
</pre>
</div>
<p>
5 page 目と 10 page 目は除いてページ数をカウントする.<br  />
上記 pageCountsBox と連動する.<br  />
各々のスライドの右下に作成される.<br  />
</p>

<p>
<img src="dat/img/layout-pagenum.png" alt="layout-pagenum.png" /><br  />
26 page 中 23 page 目<br  />
</p>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> gray out した目次を自動で作成して挿入する</h3>
<div class="outline-text-3" id="text-5-3">
<p>
関数名: p01_grayTOC<br  />
仕様:<br  />
hoge.txt に目次を以下のように書く.<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::|||::
*     3. &#12503;&#12525;&#12464;&#12521;&#12512;&#12398;&#27969;&#12428;      2
**    3.1. if &#25991;               2
***   3.1.1. if-then           2
***   3.1.2. &#38306;&#20418;&#28436;&#31639;&#23376;        9
***   &#23455;&#32722;                    10
****  &#26032;&#35215;&#12497;&#12483;&#12465;&#12540;&#12472;&#12398;&#20316;&#25104;    10
****  &#23455;&#32722;&#12392;&#28436;&#32722;              12
*     4. &#32368;&#12426;&#36820;&#12375;             13
**    4.0. &#32368;&#12426;&#36820;&#12375;&#12392;&#12399;?      13
***   4.0.1. &#12420;&#12426;&#12383;&#12356;&#12371;&#12392;     13
***   4.0.2. Java &#12391;&#12398;&#25991;      15
**    4.1. do &#25991;              16
</pre>
</div>

<p>
hoge.txt の format は以下のような感じ<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::|||::           <span style="color: #cd853f;"># </span><span style="color: #cd853f;">&#30446;&#27425;&#35501;&#12415;&#36796;&#12415;&#29992;&#12398;&#30446;&#21360;</span>
*(\t)(&#38542;&#23652;1&#12398;&#30446;&#27425;)(\t)(&#26360;&#12365;&#12384;&#12377;&#12506;&#12540;&#12472;&#25968;)   <span style="color: #cd853f;"># </span><span style="color: #cd853f;">&#27880;: &#12371;&#12398;&#12506;&#12540;&#12472;&#12398;&#21069;&#12395;&#36861;&#21152;&#12377;&#12427;. &#12371;&#12398;&#12506;&#12540;&#12472;&#20197;&#38477;&#12398;&#12506;&#12540;&#12472;&#25968;&#12364;&#12378;&#12428;&#12427;.</span>
**(\t)(&#38542;&#23652;2&#12398;&#30446;&#27425;)(\t)(&#26360;&#12365;&#12384;&#12377;&#12506;&#12540;&#12472;&#25968;)
***(\t)(&#38542;&#23652;3&#12398;&#30446;&#27425;)(\t)(&#26360;&#12365;&#12384;&#12377;&#12506;&#12540;&#12472;&#25968;)
</pre>
</div>

<p>
階層構造を示すため, "*" 階層分のアスタリスクを行頭に書く.<br  />
タブのあとに, 各々の階層の目次文字列を書く.<br  />
タブ区切り(何回でもよい)の最後に書き出すページ数を書く.<br  />
このページ数の前のページに目次を追加する.<br  />
このページ以降のページ数はずれていくことになる.<br  />
</p>

<p>
出力として, 新しい ppt ファイル(上の処理によって目次が追加された ppt hoge_grayTOC.ppt) が作成される.<br  />
追加階層目次のページだけずれを補正, 目次をカウントしないスライドとして追加した txt file も作成される(hoge_grayTOC.txt).<br  />
</p>

<p>
上の目次の階層は<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">3. &#12503;&#12525;&#12464;&#12521;&#12512;&#12398;&#27969;&#12428;
   (&#30053;)
4. &#32368;&#12426;&#36820;&#12375;
4.0. &#32368;&#12426;&#36820;&#12375;&#25991;&#12392;&#12399;
4.0.1. &#12420;&#12426;&#12383;&#12356;&#12371;&#12392;
4.0.2. Java &#12391;&#12398;&#25991;
4.1. do &#25991;
</pre>
</div>
<p>
こんな風になっている. 追加される目次スライドは,<br  />
</p>

<p>
(4 に入ります).<br  />
<img src="dat/img/layout-toc01.png" alt="layout-toc01.png" /><br  />
</p>

<p>
(4 の下の階層目次の全体を示します).<br  />
<img src="dat/img/layout-toc02.png" alt="layout-toc02.png" /><br  />
</p>

<p>
(4.0 に入ります).<br  />
<img src="dat/img/layout-toc03.png" alt="layout-toc03.png" /><br  />
</p>

<p>
(4.0 の下の階層目次の全体を示します).<br  />
<img src="dat/img/layout-toc04.png" alt="layout-toc04.png" /><br  />
</p>

<p>
(4.0.1 に入ります).<br  />
<img src="dat/img/layout-toc05.png" alt="layout-toc05.png" /><br  />
</p>

<p>
うーんちょっとしつこいかも知れないが, ちゃんとやるとこうなる筈なのでしょうがない.<br  />
どうせ 1 秒程度しか見せないんだからまぁいいかなぁと思う.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> 階層の情報を各スライドに表示する</h3>
<div class="outline-text-3" id="text-5-4">
<p>
関数名: p04_pageListContents<br  />
仕様:<br  />
hoge.txt ファイル内の目次データを参照して, gray out した目次情報を書き出す.<br  />
各々のページ(右上)に, 今やってる目次の位置を黒い色で, その他の目次の位置を gray out した状態で書き出す.<br  />
default では "::|||::" 以下にかかれる目次情報を参照するが, 独自で指定したい場合(あまり細かく書き出したくない場合など)は以下のように書くこともできる.<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::###::
1. &#32972;&#26223;              1-3
2. &#30446;&#30340;              4-6
3. &#26041;&#27861;              7-9
4. &#32080;&#26524;              10-
::$<span style="color: #9acd32;">$</span>$::
3,11-15,18
::!!!::
610   140   8
</pre>
</div>
<p>
例えば上記のように書くと, 目次としては最初の階層だけを書くことになる.<br  />
次の "::$$$::" 以下に書かれた数値は, 目次を書き出さないページ数をあらかじめ指定するものである.<br  />
この例では, 3p と 11p から 15p, 18p には目次が書かれないはず.<br  />
目次情報を書き出す場所(default では右上)に色々と書いてあって, ここに情報を載せたくない場合に使う.<br  />
"::!!!::" は書かせる場所のパラメータを指定する.<br  />
指定されていればこの値を使う. 順に書き出す x 座標, テキストボックスの幅, フォントサイズをタブ区切りで書く.<br  />
ここでは, x=610 から幅 140 のテキストボックスを作ってその上に font size = 8 のフォントで gray out された目次を書く.<br  />
無ければ default 値を使う.<br  />
</p>

<div class="org-src-container">

<pre class="src src-sh">::###::
3. &#12503;&#12525;&#12464;&#12521;&#12512;&#20998;&#23696;   2-12
3.1. if &#25991;          2-12
3.1.1. if-then      2-8
3.1.2. &#38306;&#20418;&#28436;&#31639;&#23376;   9
&#23455;&#32722;                10-12
</pre>
</div>
<p>
の場合の 12 page 目はこんな感じ.<br  />
<img src="dat/img/layout-listcontents.png" alt="layout-listcontents.png" /><br  />
</p>


<p>
関数名: p05_pageListHierarchy()<br  />
仕様:<br  />
hoge.txt ファイル内の目次データを参照して, gray out した目次情報を書き出す.<br  />
各々のページ(左上)に, 今やってる目次の位置(階層)を書きだす.<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::^^^::
1. &#32972;&#26223;           1-3
1.1. &#12399;&#12376;&#12417;&#12395;     2
1.2. &#27508;&#21490;         3
2. &#30446;&#30340;           4-6
::&amp;&amp;&amp;::
1-4,8
::???::
10   130   8
</pre>
</div>
<p>
"::^^^::" は上の "::###::" と同じで, あればこれを元に階層目次を作成する.<br  />
なければ "::|||::" (gray out する目次スライド挿入の情報)と同じ感じで書く.<br  />
"::&amp;&amp;&amp;::" はこの情報を書き出さないページ数を指定する.<br  />
"::???::" は書き出す場所, テキストボックスのサイズ, フォントの大きさを示す. 無ければ default 値を使う.<br  />
</p>

<p>
以下のように書き出される<br  />
<img src="dat/img/layout-listhierarchy.png" alt="layout-listhierarchy.png" /><br  />
</p>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5"><span class="section-number-3">5.5</span> 章ごとに分割して作成したスライドを統合する</h3>
<div class="outline-text-3" id="text-5-5">
<p>
関数名: p00_collectPpt<br  />
仕様:<br  />
hoge.pptm を作成(大抵は空の ppt ファイル)<br  />
hoge.txt に以下のように書いておく.<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::+++::
0    foos.ppt    1-3,10,45-
1    fuga.ppt    *
1    bars.ppt    20,30-40
</pre>
</div>
<p>
最初の 0 または 1 については, foos.ppt のスタイルはコピーしない(0), fuga.ppt のスタイルもコピーする(1) という意味である.<br  />
二つ目は取り込む ppt ファイル名,<br  />
三つ目は取り込むページ数である. "*" は全部という意味である.<br  />
実行すると, 上で示されたファイルを統合して新しく hoge_intg.pptm が作成される.<br  />
それぞれに付随している txt ファイルも統合されて, 新しい hoge_intg.txt ファイルが作成される.<br  />
hoge.txt を読み込むかどうか, output ppt ファイル名が hoge_intg.pptm でいいかどうか聞かれるので指定する.<br  />
</p>
</div>
</div>
<div id="outline-container-sec-5-6" class="outline-3">
<h3 id="sec-5-6"><span class="section-number-3">5.6</span> 学生用の資料を自動で作成する</h3>
<div class="outline-text-3" id="text-5-6">
<p>
関数名: p6_flipTextForStudent<br  />
仕様:<br  />
学生用に, キーワードが(_ アンダーバー等に)置換されたスライドを作成する.<br  />
演習問題の答えが載っているスライドを削除する<br  />
</p>

<p>
hoge.txt に以下のように書く<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::%%%::
Entrez Gene      Entrez ____      *
SNP              ___              1,2,3-10,20
HogeFuga         Hoge____         12
::@@@::
5,8,11
</pre>
</div>
<p>
"::%%%::" の後に置換前, 置換後, ページ数をタブ区切りで書いていく.<br  />
すべてのページで, "Entrez Gene" =&gt; "Entrez <span class="underline">__</span>" と変更(穴あけ)<br  />
1, 2, 3-10, 20 ページ で "SNP" を <span class="underline">_</span> に置換.<br  />
12 ページ のみで "HogeFuga" を "Hoge____" に変更.<br  />
"::@@@::" の後に学生用スライドでは見せないページ数を指定する.<br  />
5,8,11 ページは演習問題の答えなので削除.<br  />
</p>

<p>
ほとんどが削除するページならば, 以下のようにして残すページ数を書くことが可能<br  />
</p>
<div class="org-src-container">

<pre class="src src-sh">::===::
1-4,6,7,9,10
</pre>
</div>
<p>
この場合は, 1-4,6,7,9,10 ページは残す. それ以外は削除される.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-5-7" class="outline-3">
<h3 id="sec-5-7"><span class="section-number-3">5.7</span> 教師用の資料を作成</h3>
<div class="outline-text-3" id="text-5-7">
<p>
関数名: p7_watermarkForLecture<br  />
仕様:<br  />
hoge.txt に, 学生用の資料作成のようなテキストファイルが書かれているとする.<br  />
穴埋めの部分の文字列をイタリック体及び下線などで目立たせる.<br  />
学生用での削除ページには斜め線を目立つように入れる.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-5-8" class="outline-3">
<h3 id="sec-5-8"><span class="section-number-3">5.8</span> そのほか</h3>
<div class="outline-text-3" id="text-5-8">
</div><div id="outline-container-sec-5-8-1" class="outline-4">
<h4 id="sec-5-8-1"><span class="section-number-4">5.8.1</span> 目次スライドを消去した新しいスライドを作成する</h4>
<div class="outline-text-4" id="text-5-8-1">
<p>
関数名: p8_removeGrayTOC_asNewName<br  />
仕様:<br  />
gray out する目次スライドを削除して新しい名前の ppt を作成<br  />
</p>
</div>
</div>
<div id="outline-container-sec-5-8-2" class="outline-4">
<h4 id="sec-5-8-2"><span class="section-number-4">5.8.2</span> 目次のフォント大きさを変更</h4>
<div class="outline-text-4" id="text-5-8-2">
<p>
関数名: resizeFontSizeOfGrayTOC<br  />
仕様:<br  />
目次のフォントが大きすぎてページに入らないことがあるので, その対処<br  />
タイトル, 箇条書き部分のフォント大きさを入力するとその大きさに変更する.<br  />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> 使用例</h2>
<div class="outline-text-2" id="text-6">
<p>
<a href="https://github.com/saito1369/work-lib-Basic/tree/master/lecture/ppts">https://github.com/saito1369/work-lib-Basic/tree/master/lecture/ppts</a> も参照.<br  />
</p>

<ol class="org-ol">
<li>元となる ppt 及びテキストファイルの準備<br  />
章ごとに作成した ppt のファイル.<br  />
<ul class="org-ul">
<li>031_if.pptx<br  />
</li>
<li>041_loop.pptx<br  />
</li>
</ul>
<p>
各々に付随したテキストファイル<br  />
</p>
<ul class="org-ul">
<li>031_if.txt<br  />
</li>
<li>041_loop.txt<br  />
</li>
</ul>
</li>
<li>pptm ファイルを作成する<br  />
test.pptm:<br  />
白紙の ppt ファイル(あるいはタイトルだけ作成)<br  />
マクロを import して pptm ファイルとして保存しておく.<br  />
test.txt: 取り込むファイルと取り込み方, ページ数を書いておく.<br  />
</li>
<li>p00_collectPpt<br  />
test.pptm のマクロから, p00_collectPot を走らせる.<br  />
test.txt に基づいて統合された test_intg.pptm, test_intg.txt が作成される.<br  />
</li>
<li>p01_grayTOC<br  />
test_intg.pptm のマクロから走らせる.<br  />
test_intg.txt の目次に基づいて目次が挿入された<br  />
test_intg_gray.pptm 及び test_intg_gray.txt が作成される.<br  />
</li>
<li>p02_pageCountsBox<br  />
     目次スライド以外のスライド左下に progress bar を作成する(上書き)<br  />
</li>
<li>p03_pageNum<br  />
     目次スライド以外のスライド右下に ページ数/全ページ数 を追加(上書き)<br  />
</li>
<li>p04_pageListContents<br  />
     目次スライド以外のスライド右上に gray out した小さい目次を追加(上書き)<br  />
</li>
<li>p05_pageListHierarchy<br  />
     目次スライド以外のスライド左上に 今いるページの階層的目次を追加(上書き)<br  />
</li>
<li>p6_flipTextForStudent<br  />
学生用の穴あき資料, 及び演習問題の答えを書いたページ等を削除した ppt ファイルを作成する.<br  />
別名で保存される.<br  />
default では, _for_student が付加した test_intg_gray_for_student.pptm<br  />
という名前のファイルとして保存される.<br  />
この ppt でプレゼンをするわけではなく, 大抵の場合目次スライドはいらないので消去する.<br  />
p8_removeGrayTOC_asNewName を動かす.<br  />
default では, _delTOC が付加した test_intg_gray_for_student_delTOC.pptm<br  />
という名前のファイルとして保存される.<br  />
</li>
<li>p7_watermarkForLecture<br  />
test_intg_gray.pptm ファイル上で上記マクロを動かすと,<br  />
発表者(講師)が見る用の ppt ファイルが作成される.<br  />
学生が見えてない穴あき部分は gray out + 波線で表示される.<br  />
演習問題の答えなど, 学生には見せない(削除した)スライドには gray で斜め線が入っている.<br  />
default では, _for_teacher が付加した test_intg_gray_for_teacher.pptm<br  />
という名前のファイルとして保存される.<br  />
大抵の場合目次スライドはいらないので消去する.<br  />
p8_removeGrayTOC_asNewName を動かす.<br  />
default では, _delTOC が付加した test_intg_gray_for_teacher_delTOC.pptm<br  />
という名前のファイルとして保存される.<br  />
</li>
</ol>

<p>
3 から 8 までを default parameter で一気にやる場合は, test.pptm から p0_standard を動かす.<br  />
</p>

<p>
あらかじめ作成しておくファイルは 031_if.pptx, 041_loop.pptx 及び付随するテキストファイル.<br  />
今回の資料を作るにあたって最初に作成するファイルは, test.pptm 及び test.txt.<br  />
</p>

<p>
3-10 を実行することで, スライド一枚いちまいの全体からの位置がわかるような資料が作成できた(のか？)<br  />
講義の際に使用するファイルは   test_intg_gray.pptm<br  />
学生に配布する資料は           test_intg_gray_for_student_delTOC.pptm<br  />
発表者が手元に置いておく資料は test_intg_gray_for_teacher_delTOC.pptm<br  />
として保存される.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> そのほか注意事項</h2>
<div class="outline-text-2" id="text-7">
<p>
OS: Windows7<br  />
application: PowerPoint2010<br  />
Intel Core i7-2600K CPU @ 3.40GHz<br  />
RAM: 16GB<br  />
で動作確認.<br  />
</p>

<p>
Mac では Scripting.Directory (連想配列的なもの)が使えないのでそのままでは動かない.<br  />
</p>

<p>
結構な頻度で応答なしになる. プログラムが重いせい.<br  />
しばらく待ってると帰ってくる感じである.<br  />
特に p04_pageListContents が重いようである.<br  />
VBA よくわかんないこともあり, 計算を軽くする工夫は何もしていない点に注意する.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> 追記 <span class="timestamp-wrapper"><span class="timestamp">[2019-02-15 Fri]</span></span></h2>
<div class="outline-text-2" id="text-8">
<p>
Windows7 上の仮想マシンで Windows10/PowerPoint2016 の環境を作ったので試してみた.<br  />
</p>

<p>
OS: Windows10<br  />
application: PowerPoint2016<br  />
</p>

<p>
エラーが出て動かない.<br  />
以下のようにプログラムを修正することで対処した.<br  />
</p>
</div>

<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1"><span class="section-number-3">8.1</span> hash へのアクセス(Scripting.Dictionary)</h3>
<div class="outline-text-3" id="text-8-1">
<p>
Set hash = CreateObject("Scripting.Dictionary")<br  />
こんな感じで hash を作って, value へのアクセスは hash(key) で行っていた.<br  />
Office2010 までは特に問題なかった？と思うのだが, Office2016 ではエラーとなって止まってしまった.<br  />
これじゃダメらしい.<br  />
hash.Item(key) としないといけない.<br  />
というわけで hash(key) でエラーになってるところを全て hash.Item(key) に変更.<br  />
</p>
</div>
</div>

<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2"><span class="section-number-3">8.2</span> Sgn(array)=0 の件</h3>
<div class="outline-text-3" id="text-8-2">
<p>
配列が定義されてるかどーか調べるときに使ってた If 文.<br  />
そもそも仕様外の書き方らしい.<br  />
参照: <a href="https://qiita.com/satoko138/items/7e06dda56683065968f7">https://qiita.com/satoko138/items/7e06dda56683065968f7</a><br  />
</p>

<p>
If Sgn(array)=0 Then -&gt; If Not Not array Then &#x2026;.に変更.<br  />
ロジックが逆になる点に注意.<br  />
これでいいのかどうかよくわかんないけど, Office2016 ではこれでエラーがでなくなった.<br  />
</p>
</div>
</div>
</div>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">saito1369</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-03-09T00:00:00+09:00"  data-updated="true" itemprop="datePublished dateCreated">2018-03-09 (Fri)</time>
          


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://saito1369.github.io/blog/2018-03-09-layout.html" data-via="saito1369" data-counturl="http://saito1369.github.io/blog/2018-03-09-layout.html" >Tweet</a>
  
  
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2017-09-04-164431.html" title="Previous Post: isearch の改良">&laquo; isearch の改良</a></li>
            
            
            <li class="next"><a href="/blog/2018-10-17-172030.html" title="Next Post: desmond/maestro による MD 計算準備の自動化">desmond/maestro による MD 計算準備の自動化 &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
      <section>
        <h2>Comments</h2>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2022-09-09-Mix_C.html">混合二項分布の推定</a>
    
    <a class="list-group-item " href="/blog/2022-03-18-Stan04.html">Stan と R でベイズ統計モデリング 第四章</a>
    
    <a class="list-group-item " href="/blog/2021-05-03-DataFrame2021.html">dataframe の取り扱い [2021 版]</a>
    
    <a class="list-group-item " href="/blog/2019-04-08-161532.html">diary-float による org-mode の日付作成 (3)</a>
    
    <a class="list-group-item " href="/blog/2019-03-22-141849.html">diary-float による org-mode の日付作成 (2)</a>
    
  </div>
</section>
<section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div class="list-group">
    
    
    <a class="list-group-item " href="/blog/categories/misc/index.html">
        <span class="badge">1</span>
        misc
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/python/index.html">
        <span class="badge">6</span>
        python
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/r/index.html">
        <span class="badge">7</span>
        r
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/julia/index.html">
        <span class="badge">5</span>
        julia
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/perl/index.html">
        <span class="badge">4</span>
        perl
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/ruby/index.html">
        <span class="badge">3</span>
        ruby
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/javascript/index.html">
        <span class="badge">1</span>
        javascript
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/java/index.html">
        <span class="badge">1</span>
        java
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/org-mode/index.html">
        <span class="badge">3</span>
        org-mode
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/elisp/index.html">
        <span class="badge">5</span>
        elisp
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/clmemo/index.html">
        <span class="badge">1</span>
        clmemo
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/math/index.html">
        <span class="badge">4</span>
        math
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/emacs/index.html">
        <span class="badge">1</span>
        emacs
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/md/index.html">
        <span class="badge">2</span>
        md
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/stan/index.html">
        <span class="badge">2</span>
        stan
      </a>
    
  </div>
</section>

    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2025 - saito1369<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> and <a href="http://orgmode.org/">Org mode</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'saito1369';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://saito1369.github.io/blog/2018-03-09-layout.html';
        var disqus_url = 'http://saito1369.github.io/blog/2018-03-09-layout.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


  </body>
</html>
